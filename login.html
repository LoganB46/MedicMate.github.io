<!DOCTYPE html>
 <html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width-device-width, initial-scare=1">
        <title>Medic Mate</title>
        <link href="css/bootstrap.min.css" rel="stylesheet"/>
        <link href="css/login.css" rel="stylesheet"/>
        <script src="js/bootstrap.bundle.js"></script>
    </head>
<body>
<div class="login-wrap">
    <div class="login-card">
      <h2 class="brand">Medic Mate</h2>
      <p class="muted">Enter the company access code to continue.</p>

      <form id="loginForm" class="mt-3">
        <label for="accessCode" class="form-label">Access Code</label>
        <input
          id="accessCode"
          type="password"
          class="form-control"
          placeholder="••••••••"
          autocomplete="current-password"
          required
        />

        <div class="d-grid gap-2 mt-3">
          <button class="btn btn-primary" type="submit">Sign In</button>
          <a class="btn btn-outline-light" href="index.html">Back to Home</a>
        </div>

        <div id="loginMsg" class="mt-3" style="display:none;"></div>
      </form>
    </div>
  </div>

    <script src="js/auth.js"></script>
  <script>
    // After login, send them where they were trying to go (or default)
    const params = new URLSearchParams(location.search);
    const next = params.get("next") || "divertgui.html";

    document.getElementById("loginForm").addEventListener("submit", (e) => {
      e.preventDefault();
      const code = document.getElementById("accessCode").value;
      const ok = window.MedicMateAuth.loginWithCode(code);

      const msg = document.getElementById("loginMsg");
      msg.style.display = "block";

      if (ok) {
        msg.className = "alert alert-success";
        msg.textContent = "Access granted. Redirecting...";
        setTimeout(() => location.href = next, 500);
      } else {
        msg.className = "alert alert-danger";
        msg.textContent = "Incorrect access code.";
      }
    });
  </script>
</body>